<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Showcase - Personal Portfolio One Page Bulma Theme</title>
    <!-- Bulma Version 0.9.4-->
    <link rel="stylesheet" href="https://unpkg.com/bulma@0.9.4/css/bulma.min.css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <script
      src="https://kit.fontawesome.com/2828f7885a.js"
      integrity="sha384-WAsFbnLEQcpCk8lM1UTWesAf5rGTCvb2Y+8LvyjAAcxK1c3s5c0L+SYOgxvc6PWG"
      crossorigin="anonymous"
    ></script>
    <link rel="icon" type="image/png" href="favicon.png" />
  </head>

  <body>
    <!-- Begin Header -->
    <div class="header-wrapper" id="home">
      <!-- Begin Hero -->
      <section class="hero is-large">
        <!-- Begin Hero Content-->
        <div class="hero-body">
          <div class="container has-text-centered">
            <h1 class="subtitle">Bienvenidos a</h1>
            <h2 class="title">España</h2>
            <h1 class="subtitle supersubtitle">Un mapa de comunidades</h1>
          </div>
        </div>
        <!-- End Hero Content-->
      </section>
      <!-- End Hero -->
    </div>
    <!-- End Header -->

    <!-- Begin Main Content -->
    <div class="main-content columns is-vcentered is-desktop" style="text-align: center; margin-inline: 4rem;">
      <div id="map" class="column is-8">
        <svg id="map-spain" width="100%" height="600"></svg>
      </div>
      <div class="map-overlay">
        <div class="column">
          <h1 class="title">Comunidades Autónomas</h1>
          <p>
            Haz click en una comunidad autónoma para obtener más información
          </p>
        </div>
      </div>
    </div>
    <!-- End Main Content -->

    <!-- Begin Footer -->
    <div class="footer">
      <p>
        Based on the <a href="https://github.com/BulmaTemplates/bulma-templates/blob/master/templates/showcase.html">template made by Jeremy Thomas</a> ·
        <a href="http://opensource.org/licenses/mit-license.php">MIT License</a>
      </p>
    </div>
    <!-- End Footer -->

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
    <script src="http://d3js.org/topojson.v0.min.js"></script>
    <script>
      const width = "100%"
      const height = 600
      const prov_comAutonomas = {
        1: "Andalucia",
        2: "Aragón",
        3: "Baleares",
        4: "Canarias",
        5: "Cantabria",
        6: "Castilla-LaMancha",
        7: "CastillayLeon",
        8: "Catalunya",
        9: "Ceuta",
        10: "Extremadura",
        11: "Galicia",
        12: "LaRioja",
        13: "Madrid",
        14: "Melilla",
        15: "Murcia",
        16: "Navarra",
        17: "PaisVasco",
        18: "Asturias",
        19: "ComunidadValenciana"
      }

      var projection = d3.geo.mercator()
        .scale(1600)
        .center([-5, 39])
        .translate([width / 1.7, height / 2])
        .translate([350, 200])
        .clipAngle(180 - 1e-3)
        .precision(0.1);

      var svg = d3.select("#map-spain")
        .attr("width", width)
        .attr("height", height);

      var path = d3.geo.path()
        .projection(projection);

      // var es = "https://unpkg.com/es-atlas@0.2.0/es/municipalities.json";
      var url = "https://raw.githubusercontent.com/codeforamerica/click_that_hood/master/public/data/spain-provinces.geojson";
      
      d3.json(url, function(error, spain){
        if (error) throw error;  // Manejamos cualquier posible error
  
        var group = svg.selectAll("g")  // Creamos un grupo para cada provincia
            .data(spain.features)
            .enter()
            .append("g");
  
        // Para cada grupo añadimos el path correspondiente
        var areas = group.append("path")
            .attr("d", path)
            .attr("class", function(d) {
              return prov_comAutonomas[parseInt(d.properties.cod_ccaa)];
            })
      });
    </script>
  </body>
</html>